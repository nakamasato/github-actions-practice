name: docker-layer-cache

on:
  pull_request:
    paths:
      - Dockerfile

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v2
      - uses: satackey/action-docker-layer-caching@v0.0.8
      - name: build
        run: docker build -t test-image:latest . -f Dockerfile
      - name: check
        run: docker run --rm test-image:latest /bin/bash -c "aws --version; aws-rotate-iam-keys --version; kubectl version --client --short; kubeseal --version; cqlsh --version;"
